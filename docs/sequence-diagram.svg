<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="1724px" preserveAspectRatio="none" style="width:1585px;height:1724px;background:#FFFFFF;" version="1.1" viewBox="0 0 1585 1724" width="1585px" zoomAndPan="magnify"><title>Transaction Processing Flow - Option Trade Example</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="365.2307" x="611.5742" y="29.9659">Transaction Processing Flow - Option Trade Example</text><g><title>ApplicationRunner</title><rect fill="#FFFFFF" height="1447.0285" style="stroke:#181818;stroke-width:1;" width="10" x="198.6601" y="175.5479"/></g><g><title>TransactionCsvReader</title><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1;" width="10" x="356.9826" y="207.2539"/></g><g><title>ApplicationEventPublisher</title><rect fill="#FFFFFF" height="1043.5563" style="stroke:#181818;stroke-width:1;" width="10" x="540.3789" y="297.3719"/></g><g><title>Portfolio</title><rect fill="#FFFFFF" height="994.1443" style="stroke:#181818;stroke-width:1;" width="10" x="808.2492" y="346.784"/></g><g><title>FiscalYearManager</title><rect fill="#FFFFFF" height="196.2361" style="stroke:#181818;stroke-width:1;" width="10" x="1015.1234" y="544.0201"/></g><g><title>FiscalYearManager</title><rect fill="#FFFFFF" height="258.6481" style="stroke:#181818;stroke-width:1;" width="10" x="1015.1234" y="952.4742"/></g><g><title>FiscalYearManager</title><rect fill="#FFFFFF" height="219.2361" style="stroke:#181818;stroke-width:1;" width="10" x="1015.1234" y="1371.6343"/></g><g><title>FiscalYearRepository</title><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1;" width="10" x="1175.9775" y="575.7261"/></g><g><title>FiscalYearRepository</title><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1;" width="10" x="1175.9775" y="984.1802"/></g><g><title>FiscalYearRepository</title><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1;" width="10" x="1175.9775" y="1403.3403"/></g><g><title>FiscalYear</title><rect fill="#FFFFFF" height="101.118" style="stroke:#181818;stroke-width:1;" width="10" x="1300.4271" y="639.1381"/></g><g><title>FiscalYear</title><rect fill="#FFFFFF" height="163.5301" style="stroke:#181818;stroke-width:1;" width="10" x="1300.4271" y="1047.5922"/></g><g><title>FiscalYear</title><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1;" width="10" x="1300.4271" y="1493.4583"/></g><g><title>CurrencyExchange</title><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1;" width="10" x="1485.8563" y="670.8441"/></g><g><title>CurrencyExchange</title><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1;" width="10" x="1485.8563" y="1079.2982"/></g><rect fill="none" height="1086.9683" style="stroke:#000000;stroke-width:1.5;" width="1453.7657" x="125.6133" y="253.9599"/><rect fill="none" height="972.1443" style="stroke:#000000;stroke-width:1.5;" width="1127.1208" x="442.2583" y="361.784"/><rect fill="none" height="127.8241" style="stroke:#000000;stroke-width:1.5;" width="414.2024" x="940.8376" y="1450.0463"/><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="1516.4405" width="8" x="19.3089" y="124.1358"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="23" x2="23" y1="124.1358" y2="1640.5764"/></g><g><title>ApplicationRunner</title><rect fill="#000000" fill-opacity="0.00000" height="1516.4405" width="8" x="199.6601" y="124.1358"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="203.6133" x2="203.6133" y1="124.1358" y2="1640.5764"/></g><g><title>TransactionCsvReader</title><rect fill="#000000" fill-opacity="0.00000" height="1516.4405" width="8" x="357.9826" y="124.1358"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="361.7068" x2="361.7068" y1="124.1358" y2="1640.5764"/></g><g><title>ApplicationEventPublisher</title><rect fill="#000000" fill-opacity="0.00000" height="1516.4405" width="8" x="541.3789" y="124.1358"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="545.2583" x2="545.2583" y1="124.1358" y2="1640.5764"/></g><g><title>Portfolio</title><rect fill="#000000" fill-opacity="0.00000" height="1516.4405" width="8" x="809.2492" y="124.1358"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="812.8713" x2="812.8713" y1="124.1358" y2="1640.5764"/></g><g><title>FiscalYearManager</title><rect fill="#000000" fill-opacity="0.00000" height="1516.4405" width="8" x="1016.1234" y="124.1358"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1019.8376" x2="1019.8376" y1="124.1358" y2="1640.5764"/></g><g><title>FiscalYearRepository</title><rect fill="#000000" fill-opacity="0.00000" height="1516.4405" width="8" x="1176.9775" y="124.1358"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1180.1408" x2="1180.1408" y1="124.1358" y2="1640.5764"/></g><g><title>FiscalYear</title><rect fill="#000000" fill-opacity="0.00000" height="1516.4405" width="8" x="1301.4271" y="124.1358"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1304.8143" x2="1304.8143" y1="124.1358" y2="1640.5764"/></g><g><title>CurrencyExchange</title><rect fill="#000000" fill-opacity="0.00000" height="1516.4405" width="8" x="1486.8563" y="124.1358"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1490.3336" x2="1490.3336" y1="124.1358" y2="1640.5764"/></g><g class="participant participant-head" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.6179" x="5" y="120.0339">User</text><ellipse cx="23.3089" cy="53.5679" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M23.3089,61.5679 L23.3089,88.5679 M10.3089,69.5679 L36.3089,69.5679 M23.3089,88.5679 L10.3089,103.5679 M23.3089,88.5679 L36.3089,103.5679" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="User"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30.6179" x="5" y="1654.5423">User</text><ellipse cx="23.3089" cy="1667.1443" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M23.3089,1675.1443 L23.3089,1702.1443 M10.3089,1683.1443 L36.3089,1683.1443 M23.3089,1702.1443 L10.3089,1717.1443 M23.3089,1702.1443 L36.3089,1717.1443" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="runner"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="136.0935" x="135.6133" y="90.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122.0935" x="142.6133" y="112.0339">ApplicationRunner</text></g><g class="participant participant-tail" data-participant="runner"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="136.0935" x="135.6133" y="1639.5764"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122.0935" x="142.6133" y="1661.5423">ApplicationRunner</text></g><g class="participant participant-head" data-participant="reader"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="160.5514" x="281.7068" y="90.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="146.5514" x="288.7068" y="112.0339">TransactionCsvReader</text></g><g class="participant participant-tail" data-participant="reader"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="160.5514" x="281.7068" y="1639.5764"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="146.5514" x="288.7068" y="1661.5423">TransactionCsvReader</text></g><g class="participant participant-head" data-participant="publisher"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="186.2413" x="452.2583" y="90.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="172.2413" x="459.2583" y="112.0339">ApplicationEventPublisher</text></g><g class="participant participant-tail" data-participant="publisher"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="186.2413" x="452.2583" y="1639.5764"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="172.2413" x="459.2583" y="1661.5423">ApplicationEventPublisher</text></g><g class="participant participant-head" data-participant="portfolio"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="70.7558" x="777.8713" y="90.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56.7558" x="784.8713" y="112.0339">Portfolio</text></g><g class="participant participant-tail" data-participant="portfolio"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="70.7558" x="777.8713" y="1639.5764"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56.7558" x="784.8713" y="1661.5423">Portfolio</text></g><g class="participant participant-head" data-participant="fiscalMgr"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="138.5715" x="950.8376" y="90.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="124.5715" x="957.8376" y="112.0339">FiscalYearManager</text></g><g class="participant participant-tail" data-participant="fiscalMgr"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="138.5715" x="950.8376" y="1639.5764"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="124.5715" x="957.8376" y="1661.5423">FiscalYearManager</text></g><g class="participant participant-head" data-participant="fiscalRepo"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="149.6735" x="1106.1408" y="90.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="135.6735" x="1113.1408" y="112.0339">FiscalYearRepository</text></g><g class="participant participant-tail" data-participant="fiscalRepo"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="149.6735" x="1106.1408" y="1639.5764"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="135.6735" x="1113.1408" y="1661.5423">FiscalYearRepository</text></g><g class="participant participant-head" data-participant="fiscalYear"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="79.2258" x="1265.8143" y="90.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="65.2258" x="1272.8143" y="112.0339">FiscalYear</text></g><g class="participant participant-tail" data-participant="fiscalYear"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="79.2258" x="1265.8143" y="1639.5764"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="65.2258" x="1272.8143" y="1661.5423">FiscalYear</text></g><g class="participant participant-head" data-participant="exchange"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="137.0455" x="1422.3336" y="90.0679"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="123.0455" x="1429.3336" y="112.0339">CurrencyExchange</text></g><g class="participant participant-tail" data-participant="exchange"><rect fill="#E2E2F0" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="137.0455" x="1422.3336" y="1639.5764"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="123.0455" x="1429.3336" y="1661.5423">CurrencyExchange</text></g><g><title>ApplicationRunner</title><rect fill="#FFFFFF" height="1447.0285" style="stroke:#181818;stroke-width:1;" width="10" x="198.6601" y="175.5479"/></g><g><title>TransactionCsvReader</title><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1;" width="10" x="356.9826" y="207.2539"/></g><g><title>ApplicationEventPublisher</title><rect fill="#FFFFFF" height="1043.5563" style="stroke:#181818;stroke-width:1;" width="10" x="540.3789" y="297.3719"/></g><g><title>Portfolio</title><rect fill="#FFFFFF" height="994.1443" style="stroke:#181818;stroke-width:1;" width="10" x="808.2492" y="346.784"/></g><g><title>FiscalYearManager</title><rect fill="#FFFFFF" height="196.2361" style="stroke:#181818;stroke-width:1;" width="10" x="1015.1234" y="544.0201"/></g><g><title>FiscalYearManager</title><rect fill="#FFFFFF" height="258.6481" style="stroke:#181818;stroke-width:1;" width="10" x="1015.1234" y="952.4742"/></g><g><title>FiscalYearManager</title><rect fill="#FFFFFF" height="219.2361" style="stroke:#181818;stroke-width:1;" width="10" x="1015.1234" y="1371.6343"/></g><g><title>FiscalYearRepository</title><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1;" width="10" x="1175.9775" y="575.7261"/></g><g><title>FiscalYearRepository</title><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1;" width="10" x="1175.9775" y="984.1802"/></g><g><title>FiscalYearRepository</title><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1;" width="10" x="1175.9775" y="1403.3403"/></g><g><title>FiscalYear</title><rect fill="#FFFFFF" height="101.118" style="stroke:#181818;stroke-width:1;" width="10" x="1300.4271" y="639.1381"/></g><g><title>FiscalYear</title><rect fill="#FFFFFF" height="163.5301" style="stroke:#181818;stroke-width:1;" width="10" x="1300.4271" y="1047.5922"/></g><g><title>FiscalYear</title><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1;" width="10" x="1300.4271" y="1493.4583"/></g><g><title>CurrencyExchange</title><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1;" width="10" x="1485.8563" y="670.8441"/></g><g><title>CurrencyExchange</title><rect fill="#FFFFFF" height="31.706" style="stroke:#181818;stroke-width:1;" width="10" x="1485.8563" y="1079.2982"/></g><g class="message" data-participant-1="User" data-participant-2="runner"><polygon fill="#181818" points="186.6601,171.5479,196.6601,175.5479,186.6601,179.5479,190.6601,175.5479" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="23.3089" x2="192.6601" y1="175.5479" y2="175.5479"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="113.8281" x="30.3089" y="152.0328">./gradlew bootRun</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" text-decoration="line-through" textLength="39.624" x="30.3089" y="169.7389">args="</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116.7271" x="69.933" y="169.7389">transactionsDir=..."</text></g><g class="message" data-participant-1="runner" data-participant-2="reader"><polygon fill="#181818" points="344.9826,203.2539,354.9826,207.2539,344.9826,211.2539,348.9826,207.2539" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="208.6601" x2="350.9826" y1="207.2539" y2="207.2539"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75.6471" x="215.6601" y="201.4449">read(csvFile)</text></g><g class="message" data-participant-1="reader" data-participant-2="runner"><polygon fill="#181818" points="219.6601,234.9599,209.6601,238.9599,219.6601,242.9599,215.6601,238.9599" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="213.6601" x2="360.9826" y1="238.9599" y2="238.9599"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.5881" x="225.6601" y="233.1509">List&lt;Transaction&gt;</text></g><path d="M125.6133,253.9599 L198.9013,253.9599 L198.9013,263.6659 L188.9013,273.6659 L125.6133,273.6659 L125.6133,253.9599" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1086.9683" style="stroke:#000000;stroke-width:1.5;" width="1453.7657" x="125.6133" y="253.9599"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28.288" x="140.6133" y="268.8569">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="208.3055" x="213.9013" y="267.7188">[for each transaction (sorted by date)]</text><g class="message" data-participant-1="runner" data-participant-2="publisher"><polygon fill="#181818" points="528.3789,293.3719,538.3789,297.3719,528.3789,301.3719,532.3789,297.3719" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="208.6601" x2="534.3789" y1="297.3719" y2="297.3719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="219.6352" x="215.6601" y="291.5629">publishEvent(NewTransactionEvent)</text></g><g class="message" data-participant-1="publisher" data-participant-2="portfolio"><polygon fill="#181818" points="796.2492,342.784,806.2492,346.784,796.2492,350.784,800.2492,346.784" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="550.3789" x2="802.2492" y1="346.784" y2="346.784"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94.7311" x="557.3789" y="323.2689">@EventListener</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.7591" x="557.3789" y="340.975">onNewTransaction()</text></g><path d="M442.2583,361.784 L504.7173,361.784 L504.7173,371.49 L494.7173,381.49 L442.2583,381.49 L442.2583,361.784" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="972.1443" style="stroke:#000000;stroke-width:1.5;" width="1127.1208" x="442.2583" y="361.784"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.459" x="457.2583" y="376.681">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="169.3988" x="519.7173" y="375.5429">[Option Trade (SELL_TO_OPEN)]</text><g class="message" data-participant-1="portfolio" data-participant-2="portfolio"><line style="stroke:#181818;stroke-width:1;" x1="818.2492" x2="860.2492" y1="405.196" y2="405.196"/><line style="stroke:#181818;stroke-width:1;" x1="860.2492" x2="860.2492" y1="405.196" y2="418.196"/><line style="stroke:#181818;stroke-width:1;" x1="819.2492" x2="860.2492" y1="418.196" y2="418.196"/><polygon fill="#181818" points="829.2492,414.196,819.2492,418.196,829.2492,422.196,825.2492,418.196" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166.6472" x="825.2492" y="399.387">optionPositionSellToOpen()</text></g><g class="message" data-participant-1="portfolio" data-participant-2="portfolio"><line style="stroke:#181818;stroke-width:1;" x1="818.2492" x2="860.2492" y1="449.902" y2="449.902"/><line style="stroke:#181818;stroke-width:1;" x1="860.2492" x2="860.2492" y1="449.902" y2="462.902"/><line style="stroke:#181818;stroke-width:1;" x1="819.2492" x2="860.2492" y1="462.902" y2="462.902"/><polygon fill="#181818" points="829.2492,458.902,819.2492,462.902,829.2492,466.902,825.2492,462.902" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166.0882" x="825.2492" y="444.093">create OptionShortPosition</text></g><g class="message" data-participant-1="portfolio" data-participant-2="publisher"><polygon fill="#181818" points="561.3789,490.608,551.3789,494.608,561.3789,498.608,557.3789,494.608" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="555.3789" x2="807.2492" y1="494.608" y2="494.608"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="232.4533" x="567.3789" y="488.799">publishEvent(OptionSellToOpenEvent)</text></g><g class="message" data-participant-1="publisher" data-participant-2="fiscalMgr"><polygon fill="#181818" points="1003.1234,540.0201,1013.1234,544.0201,1003.1234,548.0201,1007.1234,544.0201" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="550.3789" x2="1009.1234" y1="544.0201" y2="544.0201"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94.7311" x="557.3789" y="520.505">@EventListener</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163.8912" x="557.3789" y="538.2111">onOptionPositionOpened()</text></g><g class="message" data-participant-1="fiscalMgr" data-participant-2="fiscalRepo"><polygon fill="#181818" points="1163.9775,571.7261,1173.9775,575.7261,1163.9775,579.7261,1167.9775,575.7261" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1025.1234" x2="1169.9775" y1="575.7261" y2="575.7261"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.0111" x="1032.1234" y="569.9171">getFiscalYear(year)</text></g><g class="message" data-participant-1="fiscalRepo" data-participant-2="fiscalMgr"><polygon fill="#181818" points="1036.1234,603.4321,1026.1234,607.4321,1036.1234,611.4321,1032.1234,607.4321" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1030.1234" x2="1179.9775" y1="607.4321" y2="607.4321"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60.567" x="1042.1234" y="601.6231">FiscalYear</text></g><g class="message" data-participant-1="fiscalMgr" data-participant-2="fiscalYear"><polygon fill="#181818" points="1288.4271,635.1381,1298.4271,639.1381,1288.4271,643.1381,1292.4271,639.1381" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1025.1234" x2="1294.4271" y1="639.1381" y2="639.1381"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163.8912" x="1032.1234" y="633.3291">onOptionPositionOpened()</text></g><g class="message" data-participant-1="fiscalYear" data-participant-2="exchange"><polygon fill="#181818" points="1473.8563,666.8441,1483.8563,670.8441,1473.8563,674.8441,1477.8563,670.8441" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1310.4271" x2="1479.8563" y1="670.8441" y2="670.8441"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156.3512" x="1317.4271" y="665.0351">usdToEur(premium, date)</text></g><g class="message" data-participant-1="exchange" data-participant-2="fiscalYear"><polygon fill="#181818" points="1321.4271,698.5501,1311.4271,702.5501,1321.4271,706.5501,1317.4271,702.5501" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1315.4271" x2="1489.8563" y1="702.5501" y2="702.5501"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99.3591" x="1327.4271" y="696.7411">premium in EUR</text></g><g class="message" data-participant-1="fiscalYear" data-participant-2="fiscalYear"><line style="stroke:#181818;stroke-width:1;" x1="1310.4271" x2="1352.4271" y1="739.2562" y2="739.2562"/><line style="stroke:#181818;stroke-width:1;" x1="1352.4271" x2="1352.4271" y1="739.2562" y2="752.2562"/><line style="stroke:#181818;stroke-width:1;" x1="1305.4271" x2="1352.4271" y1="752.2562" y2="752.2562"/><polygon fill="#181818" points="1315.4271,748.2562,1305.4271,752.2562,1315.4271,756.2562,1311.4271,752.2562" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.8071" x="1317.4271" y="733.4472">update ProfitAndLoss</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="442.2583" x2="1569.3791" y1="756.2562" y2="756.2562"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="170.7518" x="447.2583" y="768.0151">[Option Trade (BUY_TO_CLOSE)]</text><g class="message" data-participant-1="portfolio" data-participant-2="portfolio"><line style="stroke:#181818;stroke-width:1;" x1="818.2492" x2="860.2492" y1="795.9441" y2="795.9441"/><line style="stroke:#181818;stroke-width:1;" x1="860.2492" x2="860.2492" y1="795.9441" y2="808.9441"/><line style="stroke:#181818;stroke-width:1;" x1="819.2492" x2="860.2492" y1="808.9441" y2="808.9441"/><polygon fill="#181818" points="829.2492,804.9441,819.2492,808.9441,829.2492,812.9441,825.2492,808.9441" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168.0642" x="825.2492" y="790.1351">optionPositionBuyToClose()</text></g><g class="message" data-participant-1="portfolio" data-participant-2="portfolio"><line style="stroke:#181818;stroke-width:1;" x1="818.2492" x2="860.2492" y1="858.3561" y2="858.3561"/><line style="stroke:#181818;stroke-width:1;" x1="860.2492" x2="860.2492" y1="858.3561" y2="871.3561"/><line style="stroke:#181818;stroke-width:1;" x1="819.2492" x2="860.2492" y1="871.3561" y2="871.3561"/><polygon fill="#181818" points="829.2492,867.3561,819.2492,871.3561,829.2492,875.3561,825.2492,871.3561" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172.8742" x="825.2492" y="834.8411">close OptionShortPosition(s)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.3161" x="825.2492" y="852.5471">(may be partial)</text></g><g class="message" data-participant-1="portfolio" data-participant-2="publisher"><polygon fill="#181818" points="561.3789,899.0621,551.3789,903.0621,561.3789,907.0621,557.3789,903.0621" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="555.3789" x2="807.2492" y1="903.0621" y2="903.0621"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="233.8703" x="567.3789" y="897.2531">publishEvent(OptionBuyToCloseEvent)</text></g><g class="message" data-participant-1="publisher" data-participant-2="fiscalMgr"><polygon fill="#181818" points="1003.1234,948.4742,1013.1234,952.4742,1003.1234,956.4742,1007.1234,952.4742" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="550.3789" x2="1009.1234" y1="952.4742" y2="952.4742"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94.7311" x="557.3789" y="928.9591">@EventListener</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156.0392" x="557.3789" y="946.6651">onOptionPositionClosed()</text></g><g class="message" data-participant-1="fiscalMgr" data-participant-2="fiscalRepo"><polygon fill="#181818" points="1163.9775,980.1802,1173.9775,984.1802,1163.9775,988.1802,1167.9775,984.1802" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1025.1234" x2="1169.9775" y1="984.1802" y2="984.1802"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.0111" x="1032.1234" y="978.3712">getFiscalYear(year)</text></g><g class="message" data-participant-1="fiscalRepo" data-participant-2="fiscalMgr"><polygon fill="#181818" points="1036.1234,1011.8862,1026.1234,1015.8862,1036.1234,1019.8862,1032.1234,1015.8862" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1030.1234" x2="1179.9775" y1="1015.8862" y2="1015.8862"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60.567" x="1042.1234" y="1010.0772">FiscalYear</text></g><g class="message" data-participant-1="fiscalMgr" data-participant-2="fiscalYear"><polygon fill="#181818" points="1288.4271,1043.5922,1298.4271,1047.5922,1288.4271,1051.5922,1292.4271,1047.5922" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1025.1234" x2="1294.4271" y1="1047.5922" y2="1047.5922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156.0392" x="1032.1234" y="1041.7832">onOptionPositionClosed()</text></g><g class="message" data-participant-1="fiscalYear" data-participant-2="exchange"><polygon fill="#181818" points="1473.8563,1075.2982,1483.8563,1079.2982,1473.8563,1083.2982,1477.8563,1079.2982" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1310.4271" x2="1479.8563" y1="1079.2982" y2="1079.2982"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156.4292" x="1317.4271" y="1073.4892">usdToEur(buyValue, date)</text></g><g class="message" data-participant-1="exchange" data-participant-2="fiscalYear"><polygon fill="#181818" points="1321.4271,1107.0042,1311.4271,1111.0042,1321.4271,1115.0042,1317.4271,1111.0042" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1315.4271" x2="1489.8563" y1="1111.0042" y2="1111.0042"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99.4371" x="1327.4271" y="1105.1952">buyValue in EUR</text></g><g class="message" data-participant-1="fiscalYear" data-participant-2="fiscalYear"><line style="stroke:#181818;stroke-width:1;" x1="1310.4271" x2="1352.4271" y1="1160.4163" y2="1160.4163"/><line style="stroke:#181818;stroke-width:1;" x1="1352.4271" x2="1352.4271" y1="1160.4163" y2="1173.4163"/><line style="stroke:#181818;stroke-width:1;" x1="1311.4271" x2="1352.4271" y1="1173.4163" y2="1173.4163"/><polygon fill="#181818" points="1321.4271,1169.4163,1311.4271,1173.4163,1321.4271,1177.4163,1317.4271,1173.4163" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142.9091" x="1317.4271" y="1136.9012">calculate net profit/loss</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142.2331" x="1317.4271" y="1154.6073">apply German tax rules</text></g><g class="message" data-participant-1="fiscalYear" data-participant-2="fiscalYear"><line style="stroke:#181818;stroke-width:1;" x1="1310.4271" x2="1352.4271" y1="1210.1223" y2="1210.1223"/><line style="stroke:#181818;stroke-width:1;" x1="1352.4271" x2="1352.4271" y1="1210.1223" y2="1223.1223"/><line style="stroke:#181818;stroke-width:1;" x1="1305.4271" x2="1352.4271" y1="1223.1223" y2="1223.1223"/><polygon fill="#181818" points="1315.4271,1219.1223,1305.4271,1223.1223,1315.4271,1227.1223,1311.4271,1223.1223" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.8071" x="1317.4271" y="1204.3133">update ProfitAndLoss</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="442.2583" x2="1569.3791" y1="1227.1223" y2="1227.1223"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="154.6259" x="447.2583" y="1238.8812">[Stock Trade or Assignment]</text><path d="M823,1248.1042 L823,1328.1042 L1035,1328.1042 L1035,1258.1042 L1025,1248.1042 L823,1248.1042" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1025,1248.1042 L1025,1258.1042 L1035,1258.1042 L1025,1248.1042" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190.2162" x="829" y="1267.0012">Similar flow for stock positions:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181.8052" x="829" y="1284.7072">- Create StockPosition on BTO</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="152.5942" x="829" y="1302.4132">- Close position(s) on STC</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191.8412" x="829" y="1320.1192">- Publish StockSellToCloseEvent</text><g class="message" data-participant-1="runner" data-participant-2="fiscalMgr"><polygon fill="#181818" points="1003.1234,1367.6343,1013.1234,1371.6343,1003.1234,1375.6343,1007.1234,1371.6343" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="208.6601" x2="1009.1234" y1="1371.6343" y2="1371.6343"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84.8121" x="215.6601" y="1365.8253">printReports()</text></g><g class="message" data-participant-1="fiscalMgr" data-participant-2="fiscalRepo"><polygon fill="#181818" points="1163.9775,1399.3403,1173.9775,1403.3403,1163.9775,1407.3403,1167.9775,1403.3403" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1025.1234" x2="1169.9775" y1="1403.3403" y2="1403.3403"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125.6581" x="1032.1234" y="1397.5313">getAllSortedByYear()</text></g><g class="message" data-participant-1="fiscalRepo" data-participant-2="fiscalMgr"><polygon fill="#181818" points="1036.1234,1431.0463,1026.1234,1435.0463,1036.1234,1439.0463,1032.1234,1435.0463" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1030.1234" x2="1179.9775" y1="1435.0463" y2="1435.0463"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96.5251" x="1042.1234" y="1429.2373">List&lt;FiscalYear&gt;</text></g><path d="M940.8376,1450.0463 L1014.1257,1450.0463 L1014.1257,1459.7523 L1004.1257,1469.7523 L940.8376,1469.7523 L940.8376,1450.0463" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="127.8241" style="stroke:#000000;stroke-width:1.5;" width="414.2024" x="940.8376" y="1450.0463"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28.288" x="955.8376" y="1464.9433">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="111.0772" x="1029.1257" y="1463.8052">[for each fiscal year]</text><g class="message" data-participant-1="fiscalMgr" data-participant-2="fiscalYear"><polygon fill="#181818" points="1288.4271,1489.4583,1298.4271,1493.4583,1288.4271,1497.4583,1292.4271,1493.4583" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1025.1234" x2="1294.4271" y1="1493.4583" y2="1493.4583"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47.7751" x="1032.1234" y="1487.6493">profits()</text></g><g class="message" data-participant-1="fiscalYear" data-participant-2="fiscalMgr"><polygon fill="#181818" points="1036.1234,1521.1643,1026.1234,1525.1643,1036.1234,1529.1643,1032.1234,1525.1643" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1030.1234" x2="1304.4271" y1="1525.1643" y2="1525.1643"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98.6181" x="1042.1234" y="1519.3553">ProfitsSummary</text></g><g class="message" data-participant-1="fiscalMgr" data-participant-2="fiscalMgr"><line style="stroke:#181818;stroke-width:1;" x1="1025.1234" x2="1067.1234" y1="1556.8704" y2="1556.8704"/><line style="stroke:#181818;stroke-width:1;" x1="1067.1234" x2="1067.1234" y1="1556.8704" y2="1569.8704"/><line style="stroke:#181818;stroke-width:1;" x1="1026.1234" x2="1067.1234" y1="1569.8704" y2="1569.8704"/><polygon fill="#181818" points="1036.1234,1565.8704,1026.1234,1569.8704,1036.1234,1573.8704,1032.1234,1569.8704" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.8541" x="1032.1234" y="1551.0614">log profit/loss report</text></g><g class="message" data-participant-1="fiscalMgr" data-participant-2="runner"><polygon fill="#181818" points="219.6601,1586.8704,209.6601,1590.8704,219.6601,1594.8704,215.6601,1590.8704" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="213.6601" x2="1019.1234" y1="1590.8704" y2="1590.8704"/></g><g class="message" data-participant-1="runner" data-participant-2="User"><polygon fill="#181818" points="34.3089,1618.5764,24.3089,1622.5764,34.3089,1626.5764,30.3089,1622.5764" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="28.3089" x2="202.6601" y1="1622.5764" y2="1622.5764"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117.7801" x="40.3089" y="1616.7674">Tax reports printed</text></g><!--SRC=[vLPHRziW47xthq1xSgMvVO-sQMsMxYLjeZgTDAdIH6pYe66m0BVrlzy1jW4toTQfqXwMXnQRxxuxxkupfwbc16qavWeNcWgErb8KH2dAAtJDn1FAqAgn6m0g2LeyuxfX94a0BYIwLqGc3PQQ5hJ1NAFBfc6qmCRYhkMSI8GLadOLuGANS_LuHu3RGUtg6ENYaN2zRhUCght3DyD3PB8MKky4ey92XeS8SarLWTbtWkKDvhXoR3lxygQIHw1tf16Ami4xZpRlZi0zo3n5e7ah9U55jtWkzfXNn419lquIarQKVUeJXsRe_AA2z3FoXBP2QCZi0yyoB2lryLsMQPzBzONAZ-Vdv-ziWUWZrcJ8VjAJ6LgNxfbTf8LwlAQCd0KMhWWzB0i3MLAbFmJ5-vIKP6gNC24Qj8FsWAqz2i93gO9Ya19jErI2nLc2uES36wi9dlgrBNbwIvu2f_QTinrz-qQmxpsJeHtROOO-MsDp309E7xZWCNSwvHsxnxrdEXP4cY-Mon-RrO_LUd7hRAt_qUN4lx36QzD6y3ydZ6t4gY63tvEs1IGOGdB-ypti33n7R8-bisSOdVS9zInXzaPH7CpUAZgF8IDbS9OnZrvQmvRd7PqOBO6NYcWlehI3FqS9hVfYHakIJGBtV2CwQDo0wrHuLjDGmbSUEl8QC07l87bWRLMv4OjMfeqaDMthzu528jBnCp7iZ2JPDDAU2b6E5lTtXqx-WYoEBs9h6nEHkI5sL5_oSYcKEfxDqxasZM1t2LDaegYh- -z6KFFbAb-yMb5NRRSHSoOK-ID56U0XGQNgx86dDUxG5hu1viEDsTbVgSm7z6Ogisp_cyf-T-XNgcpRTjymQybRo6pWUYETmQfecR7YH8E6ZTmkuFJgWMEOXJhqbSWQSwJnCzoTZAX_AzvSY-9dhrsuyozXUAnu3Gqy4d1XXWDQxJKIk-16HS4lfpLb4EdE39rcTb2MjkchhsOHEaDpTnTQvqEBGC-WgyrgYhGQRxom3IpVp2UmVgnqZEvgzAhrJS1BUvoaVt1v238KdoxS60SKQ-Q7db10ZQHS6uL8hT9W8lDvFwddIyPoEs1TTLRKBnYi-4u8s8vtNiNHT1VADvxmt0xgXgOvBchNp6ewP4sQBcpZIO2kVrNUrZMMNNAwUG_4uLYOg49TmU1gCkuA4nYDWszoM0933G5d9_OPsXX9klAvMf8o6f0Tsoy0]--></g></svg>